\documentclass[newpage,hints,12pt,noauthor,nooutcomes]{ximera}

\input{../preamble.tex}

\title{Lines, angles, and areas in stereographic projection}
\begin{document}
\begin{abstract}
Here we look at lines, angles, and areas in stereographic projection coordinates.
\end{abstract}
\maketitle


\subsection{Stereographic projection sends lines to circles (or lines)}

As we know, we cannot make perfect flat maps of 3D surfaces. In stereographic
projection, shortest paths are sent to either lines or circles, and (perhaps
surprisingly!) circles are sent to circles.



\begin{problem}
  Show that ``lines'' in $K$-geometry correspond to either lines or circles in
  $(x_{s},y_{s})$-coordinates under stereographic projection.

  \begin{hint}
    Work in several steps:
\begin{enumerate}
\item Recall that intersecting the $K$-surface
  \[
  1 = K\left(x^2+y^2\right) + z^2 
  \]
  with the plane
  \[
  ax+by+cz = 0
  \]
  produces a $K$-geometry line.
\item Use the projection formulas
  \begin{align*}
      x &= \frac{4x_s}{K(x_s^2 + y_s^2) + 4},\\
      y &= \frac{4y_s}{K(x_s^2 + y_s^2) + 4},\\
      z &= \frac{4-K(x_s^2 + y_s^2)}{4+K(x_s^2 + y_s^2)},
  \end{align*}
  and note that the points generated this way automatically satisfy the condition
  \[
  1 = K(x^2+y^2) + z^2.
  \]
\item If $c=0$, then you will find the line
  \[
   ax_s + by_s = 0.
  \]
\item If $c\ne 0$, then you will find the circle
  \[
   \left(x_s - \frac{2a}{cK}\right)^2 + \left(y_s -
   \frac{2b}{cK}\right)^2 = \frac{4a^2 + 4b^2 + 4c^2K}{(cK)^2}.
   \]
   You will need to complete the square to convert it into this form.
\end{enumerate}
\end{hint}

\begin{freeResponse}
  Let's start by intersecting the surfaces
  \[
  K(x^2+y^2)+z^2=1\qquad\text{and}\qquad ax+by+cz=0,
  \]
  where the latter is a plane passing through the origin.  By the projection
  formulas, points which are in both of these satisfy the equation
\begin{align*}
\frac{4ax_s}{K(x_s^2 + y_s^2) + 4}+\frac{4by_s}{K(x_s^2 + y_s^2) + 4}+c\frac{4-K(x_s^2 + y_s^2)}{4+K(x_s^2 + y_s^2)}&=0\\
 \frac{4ax_s+4by_s+4c-cK(x_s^2 + y_s^2)}{4+K(x_s^2 + y_s^2)}&=0.
\end{align*}
Since $K\left(x_s^2 + y_s^2\right) + 4 \ne 0$, we may clear
denominators to find 
  \begin{align*}
    4ax_s+4by_s+4c-cK\left(x_s^2+y_s^2\right) &= 0\\
    cKx_s^2-4ax_s + cKy_s^2-4by_s-4c &= 0.
  \end{align*}
  At this point, note if $c=0$, then our equation becomes
  \begin{align*}
    4ax_s+4by_s &= 0\\
    ax_s + by_s &= 0,
  \end{align*}
  and this is the equation for a line. Now assume that $c\ne 0$ and
  complete the square(s)
  \begin{align*}
  \left(cKx_s^2 - 4ax_s + \frac{4a^2}{cK}\right) + \left(cKy_s^2 - 4by_s + \frac{4b^2}{cK}\right) &=
  \frac{4a^2}{cK} + \frac{4b^2}{cK} + 4c\\
  \left(x_s\sqrt{cK} - \frac{2a}{\sqrt{cK}}\right)^2 + \left(y_s\sqrt{cK} - \frac{2b}{\sqrt{cK}}\right)^2&=\frac{4a^2}{cK} + \frac{4b^2}{cK} + 4c.
  \end{align*}
  Multiply through by $(cK)^{-1/4}$ to find
  \begin{align*}
    \left(x_s - \frac{2a}{cK}\right)^2 + \left(y_s - \frac{2b}{cK}\right)^2 &= \frac{4a^2}{(cK)^2} + \frac{4b^2}{(cK)^2} + \frac{4c}{cK}\\
    \left(x_s - \frac{2a}{cK}\right)^2 + \left(y_s - \frac{2b}{cK}\right)^2 &= \frac{4a^2 + 4b^2 + 4c^2K}{(cK)^2}.
  \end{align*}
  This is the equation of a circle with center
  \[
  \left(\frac{2a}{cK}, \frac{2b}{cK}\right)
  \]
  and radius
  \[
  \sqrt{\frac{4a^2 + 4b^2 + 4c^2K}{(cK)^2}}.
  \]
\end{freeResponse}
\end{problem}



\begin{remark}
  With entirely similar reasoning, you can show that circles in
  stereographic projection are also sent to either circles (or lines).
\end{remark}


When we project shortest paths, they map to circles (unless $c=0$ as above).

When $K<0$, the circles meet the ``circle at infinity'' at right angles.
\textbf{We won't make you prove this, but try to convince yourself that it's true!}

\begin{center}
\begin{tikzpicture}[geometryDiagrams,scale=2]
  %% x_s-axis
  \draw [thin,->] (-1.2,0)--(1.2,0); 
  \node[right] at (1.2,0) {$x_s$};
  
  %% y_s-axis
  \draw [thin,->] (0,-1.2)--(0,1.2); 
  \node[above] at (0,1.2) {$y_s$};


  \tkzDefPoint(0,0){O}
  \tkzDefPoint(1,0){A}
  \tkzDrawCircle[ultra thick](O,A)

  \tkzDefPoint(0.2,-0.5){z1}
  \tkzDefPoint(-0.3,-0.25){z2}
  \tkzDefPoint(0.3,0.3){z3}
  \tkzDefPoint(-0.3,0.3){z4}
  \tkzDefPoint(.7,-.3){z5}
  
  \tkzClipCircle(O,A)
  \tkzDrawCircle[orthogonal through=z1 and z2](O,A)
  \tkzDrawCircle[orthogonal through=z3 and z4](O,A)
  \tkzDrawCircle[orthogonal through=z3 and z5](O,A)
  \tkzDrawPoints[color=black,fill=black,size=3](z3)
  
  %\tkzLabelPoints(z1,x2)
\end{tikzpicture}
\end{center}

\begin{problem}
  If $K<0$ explain why Euclid's fifth axiom:
  \begin{quote}
    Through a point not on a line there passes a unique parallel line.
  \end{quote}
  fails.
  \begin{freeResponse}
    Given a point not on a line, we see that there are many lines
    parallel to the original line through that point.
  \end{freeResponse}
\end{problem}







\subsection{Stereographic projection preserves angles}


A remarkable fact about stereographic projection is that it
``preserves'' angles. This means that the angles we see in
stereographic projection are true representations of the angle in
euclidean coordinates.  Now that we are masters of dot products, we
will prove this fact with ease!

\begin{problem}
  Show that
  \[
  \frac{\mathbf{v}_s\bullet_s \mathbf{w}_s}{|\mathbf{v}_s|_s\cdot|\mathbf{w}_s|_s} = \frac{\mathbf{v}_s\bullet \mathbf{w}_s}{|\mathbf{v}_s|\cdot|\mathbf{w}_s|}.
  \]
  \begin{hint}
    On the right-hand side we are using the euclidean dot product and
    euclidean length formula.
  \end{hint}
    \begin{freeResponse}
    Let
      \[
      \mathbf{v}_s=
      \begin{bmatrix}
        a & b
      \end{bmatrix}
      \qquad\text{and}\qquad
      \mathbf{w}_s=
      \begin{bmatrix}
        c & d
      \end{bmatrix}.
      \]
      Write
      \begin{align*}
        \frac{\mathbf{v}_s\bullet_s \mathbf{w}_s}{|\mathbf{v}_s|_s\cdot|\mathbf{w}_s|_s} &= \frac{
          \begin{bmatrix}
            a & b
          \end{bmatrix}
          \begin{bmatrix}
            \rho^2 & 0 \\
            0 & \rho^2
          \end{bmatrix}
          \begin{bmatrix}
            c\\
            d
          \end{bmatrix}
        }{
          \sqrt{\begin{bmatrix}
            a & b
          \end{bmatrix}
          \begin{bmatrix}
            \rho^2 & 0 \\
            0 & \rho^2
          \end{bmatrix}
          \begin{bmatrix}
            a\\
            b
          \end{bmatrix}}
          \cdot
          \sqrt{\begin{bmatrix}
            c & d
          \end{bmatrix}
          \begin{bmatrix}
            \rho^2 & 0 \\
            0 & \rho^2
          \end{bmatrix}
          \begin{bmatrix}
            c\\
            d
          \end{bmatrix}}
        }\\
        &= \frac{ac\rho^2 + bd\rho^2}{\sqrt{a^2\rho^2+b^2\rho^2}\cdot \sqrt{c^2\rho^2+d^2\rho^2}}\\
        &= \frac{\rho^2(ac + bd)}{\rho^2\sqrt{a^2+b^2}\cdot \sqrt{c^2+d^2}}\\
        &= \frac{ac + bd}{\sqrt{a^2+b^2}\cdot \sqrt{c^2+d^2}}\\
        &=\frac{\mathbf{v}_s\bullet \mathbf{w}_s}{|\mathbf{v}_s|\cdot|\mathbf{w}_s|}.
    \end{align*}
  \end{freeResponse}
\end{problem}


\begin{problem}
  Explain how the last problem shows that stereographic projection
  ``preserves'' angles. 
\end{problem}




%% \begin{problem}
%% Draw a picture of an angle between two paths through a point on
%%   the Euclidean $R$-sphere and the stereographic projection of that
%%   angle onto the plane $\hat{z}=R$. Try to give an intuitive geometric
%%   explanation for why it should have the same measure as the original
%%   angle.
%% \end{problem}
















\subsection{Areas in stereographic projection coordinates}

Let's use the power of stereographic coordinates to compute the areas
of spherical, hyperbolic, and euclidean circles. Working as we did
before, we know the area of the parallelogram spanned by two vectors
in $K$-warped space is%
  \begin{align*}
  \sqrt{\det
    \begin{bmatrix}
      \mathbf{v}\bullet_{K}\mathbf{v} & \mathbf{w}\bullet_{K}\mathbf{v}\\
      \mathbf{v}\bullet_{K}\mathbf{w} & \mathbf{w}\bullet_{K}\mathbf{w}
    \end{bmatrix}}
  &=\sqrt{\det
    \begin{bmatrix}
      \mathbf{v}_s\bullet_{s}\mathbf{v}_s & \mathbf{w}_s\bullet_{s}\mathbf{v}_s\\
      \mathbf{v}_s\bullet_{s}\mathbf{w}_s & \mathbf{w}_s\bullet_{s}\mathbf{w}_s
    \end{bmatrix}}\\
  &=
  \sqrt{\det\left({\renewcommand*{\arraystretch}{1.4} 
      \begin{bmatrix}
        \mathbf{v}_s^\transpose \\
        \mathbf{w}_s^\transpose
      \end{bmatrix}}
      \cdot P_s\cdot 
      \begin{bmatrix}
        \mathbf{v}_s & \mathbf{w}_s%
      \end{bmatrix}
    \right) }.
  \end{align*}
  In particular, if we want to know the area spanned by unit vectors
  \[
  \mathbf{v}_s = \begin{bmatrix}
    1\\
    0
  \end{bmatrix}
  \qquad\text{and}\qquad
    \mathbf{w}_s = \begin{bmatrix}
    0\\
    1
  \end{bmatrix}
    \]
    we find the area is exactly $\sqrt{\det P_s}$. This means that to
    compute area of a region $C_s$ using integrals, but in stereographic
    projection, we use
    \[
    \iint_{C_s} \sqrt{\det P_s}\d x_s\d y_s.
    \]
\begin{problem}
  Compute $\sqrt{\det P_s}$ in terms of $K$, $x_s$, and $y_s$.
\end{problem}

For the next few problems, consider the following diagram:
%% \begin{image}
%%   \includegraphics[width=3in]{stereoCirc.png}
%% \end{image}
\begin{center}
\begin{tikzpicture}[geometryDiagrams,scale=2]
    \tkzDefPoint(0,0){O}
    \tkzDefPoint(.5,0){A}
    \tkzDrawCircle[ultra thick,fill=black!10!white](O,A)

  %% x_s-axis
  \draw [thin,->] (-1.2,0)--(1.2,0); 
  \node[right] at (1.2,0) {$x_s$};
  
  %% y_s-axis
  \draw [thin,->] (0,-1.2)--(0,1.2); 
  \node[above] at (0,1.2) {$y_s$};

  \draw [
    thin,
    decoration={
        brace,
        mirror,
        raise=0.1cm
    },
    decorate
] (.03,0) -- (.47,0) node [pos=0.5,anchor=north,yshift=-0.1cm] {$a$}; 
\end{tikzpicture}
\end{center}


\begin{problem}
  Compute the area of $C_s$ in $K$-geometry by taking the integral
  \[\iint_{C_s} \sqrt{\det P_s}dx_sdy_s.\]
  \begin{hint}
    In the previous problem, you should have obtained
    \[\sqrt{\det P_s}=\frac{16}{(K(x_s^2+y_s^2)+4)^2}.\]
  \end{hint}
  \begin{hint}
    This integral is easiest to compute in polar coordinates.  Recall that to
    convert to polar coordinates, you must set
    \begin{align*}
      r &= \sqrt{x_s^2+y_s^2},\\
      \theta &= \arctan(y_s/x_s),
    \end{align*}
    and replace $\d x_s\d y_s$ with $r\d r\d \theta$.
  \end{hint}
  \begin{freeResponse}
    \[
    \int_{C_s} \frac{16}{\left(K\left(x_s^2+y_s^2\right)+4\right)^2} \d x_s\d y_s
    =\int_0^{2\pi}\int_0^a \frac{16}{\left(K\cdot r^2+4\right)^2} r\d r \d \theta.
    \]
    Integrating this from the inside out we find
    \begin{align*}
      \int_0^{2\pi} \int_0^a \frac{16}{\left(K\cdot r^2+4\right)^2} r\d r \d \theta
      &= \int_0^{2\pi} \eval{\frac{-8}{K\left(K\cdot r^2+4\right)}}_0^a \d \theta\\
      &= \int_0^{2\pi} \frac{-8}{K\left(K\cdot a^2+4\right)}+\frac{2}{K} \d \theta\\
      &= \frac{4\pi}{K}-\frac{16\pi}{K\left(K\cdot a^2+4\right)}. \\
      &= \frac{4\pi a^2}{Ka^2+4}.
    \end{align*}
  \end{freeResponse}
\end{problem}
\begin{problem}
  Explain why the radius of $C_s$ in $K$-geometry is given by
  \[r=\int_0^a \sqrt{\left(\frac{dx_s}{dt},\frac{dy_s}{dt}\right)
    \bullet_s \left(\frac{dx_s}{dt},\frac{dy_s}{dt}\right)}dt\]
  where
  \[(x_s(t),y_s(t))=(t,0).\]
\end{problem}

\begin{problem}
  When $K>0$, find $a$ in terms of the radius $r$ from the previous problem.
  \begin{hint}
    There are two ways of going about this:
    \begin{itemize}
    \item Compute the integral from the previous problem, using the fact that
      \[\frac{d}{dx}\arctan(Ax)=\frac{A}{1+(Ax)^2}.\]
      Then solve for $a$.
    \item \textbf{Or,} consider the following diagram in Euclidean geometry and
      use facts about circles and triangles:
      \begin{image}
        \includegraphics[width=3in]{stereoSphere.png}
      \end{image}
    \end{itemize}
  \end{hint}
\end{problem}

\begin{problem}
  When $K>0$, plug in and simplify to get a formula for the area of a circle in
  $K$-geometry in terms of its radius $r$.
\end{problem}

\begin{problem}
  What happens as $r$ approaches $\pi R=\pi K^{-1/2}$?

  When $r$ gets very small, what happens to $\frac{\text{area}}{r^2}$?

  Explain how these computations square with our understanding of spheres.
\end{problem}

\begin{problem}
  When $K<0$, find $a$ in terms of the radius $r$.
  \begin{hint}
    There are two ways of going about this:
    \begin{itemize}
    \item Compute the integral from a previous problem,  using the fact that
      \[\frac{d}{dx}\mathrm{artanh}(Ax)=\frac{A}{1-(Ax)^2}.\]
      Then solve for $a$.
    \item \textbf{Or,} use the fact that the $K$-length of the line
      $$\text{from}\quad(1,0,0)\quad\text{to}\quad
      (|K|^{-1/2}\sinh(\sigma),0,\cosh(\sigma))$$
      is $|K|^{-1/2}\sigma$, and compare that to the length of its stereographic
      projection onto the plane $z=1$.  Use the identities
      \begin{align*}
        \cosh(2x) &= 2\cosh^2(x)-1 \\
        \sinh(2x) &= 2\sinh(x)\cosh(x).
      \end{align*}
      to simplify.
    \end{itemize}
  \end{hint}
  \begin{hint}
    This problem is potentially more involved than the spherical version, but in
    the end you should get the same answer with an extra ``h''.
  \end{hint}
\end{problem}

\begin{problem}
  When $K<0$, plug in to get a formula for the area of a circle in $K$-geometry
  in terms of its radius $r$.
\end{problem}

Notice that for big enough $x$, $\sinh(x) \approx e^x/2$, since the $e^{-x}$ term
is pretty much zero.  So the area of a circle in hyperbolic geometry grows
exponentially with radius, unlike in Euclidean geometry where it only grows
quadratically.  There's a \textbf{lot} of space within radius $r$ of a point in
the hyperbolic plane.


\begin{problem}
  When $r$ gets very small, what happens to $\frac{\text{area}}{r^2}$?  Explain
  why this makes sense.
  \begin{freeResponse}
    This makes sense because we already discussed that at small scales,
    hyperbolic geometry ``looks linear''.
  \end{freeResponse}
\end{problem}

\subsection{Stereographic projection unifies euclidean, spherical, and hyperbolic geometry}


Under stereographic projection, our new dot product defined by
\[
\mathbf{v}_s\bullet_s \mathbf{w}_s = \mathbf{v}_s^\transpose \cdot P_s \cdot \mathbf{w}_s
\]
make sense when $K$ is zero, positive, and negative. Hence this dot
product makes sense for euclidean, spherical, and hyperbolic
geometry. However, in stereographic projection, shortest paths on the
$K$-surface
\[
K(x^2 + y^2) + z^2 = 1
\]
map to circles (or lines) in the plane $z=1$. The advantage of
stereographic projection over central projection is that angles are
preserved in stereographic projection. This means that when angles are
projected into the plane via stereographic projection, the angle we
see in the $(x_s,y_s)$-plane is the actual angle between two
vectors. Summarizing, we have:



\[
  {\renewcommand{\arraystretch}{2.7}
  \begin{array}{|c||c|c|c|}\hline
    & \text{Spherical (}K>0) & \text{Euclidean (}K=0) & \text{Hyperbolic (}K<0)\\
    \hline\hline
    \text{Surface in euclidean space}
    & \hat{x}^{2}+\hat{y}^{2}+\hat{z}^{2}=R^{2} & \text{DNE}  & \text{DNE} \\\hline
    \text{Euclidean dot product} & \hat{\mathbf v}^\transpose\cdot \hat{\mathbf w}
                             & \text{DNE}  & \text{DNE}\\\hline
    \text{Surface in $K$-warped space}
    & {1=K(x^{2}+y^{2})+z^{2}} & 1=K(x^{2}+y^{2})+z^{2} & 1=K(x^{2}+y^{2})+z^{2}\\\hline
    K\text{-dot product}
    & \mathbf v^\transpose \left[\begin{smallmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & K^{-1}
      \end{smallmatrix}\right] \mathbf w &  \text{DNE}
    & \mathbf{v}^\transpose \left[\begin{smallmatrix}1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & K^{-1}\end{smallmatrix}\right]\mathbf w \\\hline
    \text{Central dot product} & \multicolumn{3}{c|}{
        \mathbf{v}_c^\transpose \cdot P_c \cdot \mathbf{w}_c
        = \mathbf{v}_c^\transpose\left[\begin{smallmatrix}
            \left(Ky_c^2+1\right)\lambda^4 & -Kx_{c}y_{c}\lambda^4 \\
            -Kx_{c}y_{c}\lambda^4 & \left(Kx_c^2+1\right)\lambda^4
          \end{smallmatrix}\right] \mathbf{w}_c}\\\hline
    \text{Stereographic dot product} & \multicolumn{3}{c|}{
        \mathbf{v}_s^\transpose\cdot P_s\cdot \mathbf{w}_s
        = \mathbf{v}_s^\transpose\left[\begin{smallmatrix}
            \rho^2 & 0\\ 0 & \rho^2
          \end{smallmatrix}\right] \mathbf{w}_s}\\\hline
\end{array}}
\]





\begin{problem}
Summarize the results from this section. In particular, indicate which
results follow from the others.
\begin{freeResponse}
\end{freeResponse}
\end{problem}


\end{document}
