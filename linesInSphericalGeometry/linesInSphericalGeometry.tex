\documentclass[newpage,hints,handout,noauthor,nooutcomes,12pt]{ximera}

\input{../preamble.tex}

\title{Lines in spherical geometry}
\begin{document}
\begin{abstract}
Here we examine ``lines'' in spherical geometry and prove a spherical
version of the Pythagorean Theorem.
\end{abstract}
\maketitle



We next will figure out what is the shortest path you can take between
two points on the euclidean $R$-sphere. However, we will do our
calculation using $(x,y,z)$-coordinates, as we won't have
$(\hat{x},\hat{y},\hat{z})$-coordinates when we get to hyperbolic
geometry.


\subsection{Spherical coordinates, a shortest path from the North Pole}


For our purposes, it will be convenient to parameterize the sphere in
$K$-geometry:%
\begin{align*}
x(\sigma,\tau) &=R\cdot \sin\sigma\cdot \cos \tau,\\
y(\sigma,\tau) &=R\cdot \sin\sigma\cdot \sin\tau,\\
z(\sigma,\tau) &=\cos \sigma,
\end{align*}
where $0\le \sigma\le\pi$ and $0\le \tau<2\pi$.

\begin{center}
  \begin{tikzpicture}[geometryDiagrams,scale=1.7]  
      %% x-axis
      \draw [thin,->] (2.2,1.1)--(-2.2,-1.1); 
      \node[below left] at (-2.2,-1.1) {$x$};

      %% y-axis
      \draw [thin,->] (-2.2,0)--(2.5,0); 
      \node[right] at (2.5,0) {$y$};

      %% z-axis
      \draw [thin,->] (0,-2)--(0,2.2); 
      \node[above] at (0,2.2) {$z$};

      
      
      %% sphere
      \draw (1.75,0) arc (0:360:1.75);
      %%%% Equator
      \draw (-1.75,0) arc (180:360:1.75 and .5);
      \draw[thin,dashed,gray] (1.75,0) arc (0:180:1.75 and .5);

      
      
      %%%% line to point
      %\draw[thin,gray] (0,0)--(.88,1.21);
      \draw[thin,gray] (0,0)--(.88,-.2)--(.88,1.21) -- (0,0) -- cycle;

      
      %%%% point on sphere
      \draw[fill=black] (.88,1.21) circle (.05);
      \node at (1.6,1.6) {$(x,y,z)$};

      %% angles:
      \draw[thin,->] (-.4,-.2) arc (206:342:.5 and .25);
      \node at (.1,-.2) {$\tau$};
      
      \draw[thin,->] (0,.6) arc (90:60:.6);
      \node at (.1,.3) {$\sigma$}; 
  \end{tikzpicture}  
\end{center}


\begin{problem}
  Show that these functions actually parameterize the $R$-sphere.
\begin{hint}
This is an exercise in ``double-containment'': you must show that every point
specified in this way is a point on the sphere and vice versa.  To show the one
direction, show
\[
K\left(x(\sigma,\tau) ^{2}+y(\sigma,\tau) ^{2}\right) +z(\sigma,\tau)^{2} = 1
\]
for all $(\sigma,\tau)$. To show the other direction, appeal to the
diagram above.
\end{hint}
\begin{freeResponse}
  $(\subseteq)$ We will first show that the set determined by
  \[
  \left(x(\sigma,\tau), y(\sigma,\tau), z(\sigma,\tau)\right)
  \]
  lies on the surface
  \[
  K\left(x(\sigma,\tau) ^{2}+y(\sigma,\tau) ^{2}\right) +z(\sigma,\tau)^{2} = 1
  \]
  where $K=\frac{1}{R^2}>0$. Substituting we have
  $K\left(x(\sigma,\tau) ^{2}+y(\sigma,\tau) ^{2}\right)
  +z(\sigma,\tau)^{2}$
  \begin{align*}
    &=K\left((R\cdot\sin\sigma\cdot\cos\tau)^{2}+(R\cdot\sin\sigma\cdot\sin\tau)^{2}\right) +(\cos\sigma)^{2} \\
    &= \sin^2\sigma\cdot\cos^2\tau+\sin^2\sigma\sin^2\tau + \cos^2\sigma \\
    &= \sin^2\sigma(\cos^2\tau+\sin^2\tau) + \cos^2\sigma \\
    &= \sin^2\sigma + \cos^2\sigma \\
    &=1.
  \end{align*}

  $(\supseteq)$ Now we must show that every point on the surface can be obtained from
  \[
  \left(x(\sigma,\tau), y(\sigma,\tau), z(\sigma,\tau)\right).
  \]
  We see this from the diagram above. 
\end{freeResponse}
\end{problem}




If we are going to describe paths on the $R$-sphere by paths in the
$(\sigma,\tau)$-plane, we should state a map from this plane to
$(x,y,z)$-space.
\begin{center}
\begin{tikzcd}[column sep=large,row sep = huge,ampersand replacement = \&]
  (\sigma,\tau)\in \R^2 \ar[r,|->,"S_R"] \& (x, y , z) \in \R^3
\end{tikzcd}
\end{center}
Explicitly we will write:
\[
S_R(\sigma,\tau) = 
\begin{bmatrix}
x(\sigma,\tau)  \\
y(\sigma,\tau)  \\
z(\sigma,\tau)  
\end{bmatrix}
=
\begin{bmatrix}
  R\cdot \sin\sigma\cdot \cos \tau  \\
  R\cdot \sin\sigma\cdot \sin\tau\\
R\cdot \cos \sigma \\
\end{bmatrix}.
\]


Now we will find the $K$-dot product in $(\sigma,\tau)$-coordinates so
that we can compute the lengths of paths in terms of these
coordinates.

\begin{problem}
  Suppose we have a curve $\gamma$ in $K$-warped space which we can decompose as


    \begin{center}
    \begin{tikzcd}[column sep=large,row sep = huge,ampersand replacement=\&]
      t\in\R \ar[r,|->,"\gamma_\mathrm{sph}"] \ar[rd,|->,swap,"\gamma=S_R\circ \gamma_\mathrm{sph}"] \&  (\sigma(t),\tau(t))\in\R^2\ar[d,|->,"{S_R}"] \\
      \& \gamma(t)=( x(t), y(t), z(t))\in\R^3 
    \end{tikzcd}
    \end{center}

Use the chain rule to compute
\[
\dd[x]{t},\qquad \dd[y]{t}, \qquad \dd[z]{t},
\]
in terms of $\dd[\sigma]{t}$, $\dd[\tau]{t}$, $\pp[x]{\sigma}$,
$\pp[y]{\sigma}$, $\pp[z]{\sigma}$, $\pp[x]{\tau}$, $\pp[y]{\tau}$,
and $\pp[z]{\tau}$.
\begin{hint}
  Recall that if $F$ is a differentiable function of $a$ and $b$; and if $x$ and
  $y$ are all differentiable functions of $t$, then the chain rule states
  \[
  \dd[F]{t} = \nabla F \dot
  \begin{bmatrix}
    dx/dt \\ dy/dt
  \end{bmatrix}
  .
  \]
\end{hint}
\begin{freeResponse}
  Write
  \begin{align*}
    \dd[x]{t} &= \begin{bmatrix}\pp[x]{\sigma} & \pp[x]{\tau}\end{bmatrix}\cdot\begin{bmatrix}\dd[\sigma]{t} & \dd[\tau]{t}\end{bmatrix}^\transpose = \pp[x]{\sigma}\cdot\dd[\sigma]{t}+\pp[x]{\tau}\cdot\dd[\tau]{t}, \\
    \dd[y]{t} &= \begin{bmatrix}\pp[y]{\sigma} & \pp[y]{\tau}\end{bmatrix}\cdot\begin{bmatrix}\dd[\sigma]{t} & \dd[\tau]{t}\end{bmatrix}^\transpose = \pp[y]{\sigma}\cdot\dd[\sigma]{t}+\pp[y]{\tau}\cdot\dd[\tau]{t}, \\
    \dd[z]{t} &= \begin{bmatrix}\pp[z]{\sigma} & \pp[z]{\tau}\end{bmatrix}\cdot\begin{bmatrix}\dd[\sigma]{t} & \dd[\tau]{t}\end{bmatrix}^\transpose = \pp[z]{\sigma}\cdot\dd[\sigma]{t}+\pp[z]{\tau}\cdot\dd[\tau]{t}.  
  \end{align*}
\end{freeResponse}
\end{problem}

\begin{problem}
  With the same setting as in the previous problem, rewrite the result
  of your computation in matrix notation to find $D_{\mathrm{sph}}$ such
  that
\[
\begin{bmatrix}
dx/dt\\ dy/dt \\ dz/dt
\end{bmatrix}
= D_{\mathrm{sph}} \cdot
\begin{bmatrix}
d\sigma/dt \\ d\tau/dt
\end{bmatrix}
\]
in terms of $\pp[x]{\sigma}$, $\pp[y]{\sigma}$, $\pp[z]{\sigma}$,
$\pp[x]{\tau}$, $\pp[y]{\tau}$, and $\pp[z]{\tau}$.
\begin{freeResponse}
  \[
  D_{\mathrm{sph}} =
  \begin{bmatrix}
    \pp[x]{\sigma} & \pp[y]{\sigma} & \pp[z]{\sigma} \\
    \pp[x]{\tau}   & \pp[y]{\tau}   & \pp[z]{\tau}
  \end{bmatrix}.
  \]
\end{freeResponse}
\end{problem}


\begin{problem}
  Now find $P_\mathrm{sph}$ in terms of $K$, $\pp[x]{\sigma}$, $\pp[y]{\sigma}$,
  $\pp[z]{\sigma}$, $\pp[x]{\tau}$, $\pp[y]{\tau}$, and $\pp[z]{\tau}$
  such that
  \[
  \left(\dd[x]{t}, \dd[y]{t}, \dd[z]{t}\right)\bullet_K
  \left(\dd[x]{t}, \dd[y]{t}, \dd[z]{t}\right)
  =
  \begin{bmatrix}
    \dd[\sigma]{t} &  \dd[\tau]{t}
  \end{bmatrix}
  \cdot P_\mathrm{sph}
  \cdot
  \begin{bmatrix}
    d\sigma/dt \\  d\tau/dt
  \end{bmatrix}.
  \]
  \begin{freeResponse}
    Working from the $K$-dot product, we need that
    \begin{align*}
    \left(\dd[x]{t}, \dd[y]{t}, \dd[z]{t}\right)\bullet_K
    \left(\dd[x]{t}, \dd[y]{t}, \dd[z]{t}\right)
    &=
    \begin{bmatrix}
      \dd[x]{t} & \dd[y]{t} & \dd[z]{t}
    \end{bmatrix}
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
      0 & 0 & K^{-1}
    \end{bmatrix}
    \begin{bmatrix}
      \dd[x]{t} \\ \dd[y]{t} \\ \dd[z]{t}
    \end{bmatrix}\\
    &=
    \begin{bmatrix}
      \frac{d\sigma}{dt} & \frac{d\tau}{dt}
    \end{bmatrix}\cdot D_{\mathrm{sph}}\cdot
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
    0 & 0 & K^{-1}
    \end{bmatrix}
    \cdot
    \left(
    \begin{bmatrix}
      \frac{d\sigma}{dt} & \frac{d\tau}{dt}
    \end{bmatrix}\cdot D_{\mathrm{sph}}
    \right)^\transpose\\
    &=
    \begin{bmatrix}
      \frac{d\sigma}{dt} & \frac{d\tau}{dt}
    \end{bmatrix}\cdot D_{\mathrm{sph}}\cdot
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
    0 & 0 & K^{-1}
    \end{bmatrix}
    \cdot
    D_{\mathrm{sph}}^\transpose
    \cdot \begin{bmatrix}
      \frac{d\sigma}{dt} \\ \frac{d\tau}{dt}
    \end{bmatrix}.
  \end{align*}
    Hence
    \begin{align*}
      P_\mathrm{sph} &=
      \begin{bmatrix}
        \pp[x]{\sigma} & \pp[y]{\sigma} & \pp[z]{\sigma} \\
        \pp[x]{\tau} & \pp[y]{\tau} & \pp[z]{\tau}
      \end{bmatrix}
      \begin{bmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & K^{-1}
      \end{bmatrix}
      \begin{bmatrix}
        \pp[x]{\sigma} & \pp[x]{\tau}\\ 
        \pp[y]{\sigma} & \pp[y]{\tau}\\
        \pp[z]{\sigma} & \pp[z]{\tau}
      \end{bmatrix}\\
      &=
      \begin{bmatrix}
        \left(\pp[x]{\sigma}\right)^2 + \left(\pp[y]{\sigma}\right)^2 + \left(\pp[z]{\sigma}\right)^2K^{-1} & \pp[x]{\sigma}\pp[x]{\tau} + \pp[y]{\sigma}\pp[y]{\tau} + \pp[z]{\sigma}\pp[z]{\tau} K^{-1}\\
        \pp[x]{\sigma}\pp[x]{\tau} + \pp[y]{\sigma}\pp[y]{\tau} + \pp[z]{\sigma}\pp[z]{\tau} K^{-1}       & \left(\pp[x]{\tau}\right)^2 + \left(\pp[y]{\tau}\right)^2 + \left(\pp[z]{\tau}\right)^2K^{-1}
      \end{bmatrix}.
    \end{align*}
  \end{freeResponse}
\end{problem}


\begin{problem}
  Set
  \begin{align*}
    x(\sigma,\tau) &=R\cdot \sin\sigma\cdot \cos \tau,\\
    y(\sigma,\tau) &=R\cdot \sin\sigma\cdot \sin\tau,\\
    z(\sigma,\tau) &=\cos \sigma,
  \end{align*}
  and show that $P_\mathrm{sph}$ from the problem above is
  \[
  P_\mathrm{sph} =
  \begin{bmatrix}
    R^2 & 0 \\
    0 & R^2\cdot\sin^2 \sigma
  \end{bmatrix}.
  \]
  \begin{freeResponse}
    Write
    \[
    \begin{split}
      \pp[x]{\sigma} &= R\cdot \cos\sigma\cdot \cos \tau, \\
      \pp[y]{\sigma} &= R\cdot \cos\sigma\cdot \sin\tau,\\
      \pp[z]{\sigma} &= -\sin\sigma,
    \end{split}
    \qquad
    \begin{split}
      \pp[x]{\tau} &= -R\cdot \sin\sigma\cdot \sin \tau,\\
      \pp[y]{\tau} &= R\cdot \sin\sigma\cdot \cos\tau,\\
      \pp[z]{\tau} &= 0. 
    \end{split}
    \]
    Now we see $\left(\pp[x]{\sigma}\right)^2 + \left(\pp[y]{\sigma}\right)^2 + \left(\pp[z]{\sigma}\right)^2K^{-1}$
    \begin{align*}
      &= \left(R\cdot \cos\sigma\cdot \cos \tau \right)^2 + \left(R\cdot \cos\sigma\cdot \sin\tau\right)^2 + \left(-\sin\sigma\right)^2K^{-1}\\
      &= R^2\cdot \cos^2\sigma\cdot \cos^2 \tau + R^2\cdot \cos^2\sigma\cdot \sin^2\tau + R^2 \sin^2\sigma \\
      &= R^2\cdot \cos^2\sigma\left(\cos^2 \tau + \sin^2\tau\right) + R^2 \sin^2\sigma \\
      &= R^2\left(\cos^2\sigma + \sin^2\sigma\right) \\
      &= R^2.
    \end{align*}
    That $\pp[x]{\sigma}\pp[x]{\tau} + \pp[y]{\sigma}\pp[y]{\tau} + \pp[z]{\sigma}\pp[z]{\tau} K^{-1}$
    \begin{align*}
      &= -R^2\cdot \cos\sigma\cdot \cos \tau \cdot \sin\sigma\cdot \sin \tau + R^2\cdot \cos\sigma\cdot \cos \tau \cdot \sin\sigma\cdot \sin \tau\\
      &= 0.
    \end{align*}
    And finally that $\left(\pp[x]{\tau}\right)^2 + \left(\pp[y]{\tau}\right)^2 + \left(\pp[z]{\tau}\right)^2K^{-1}$
     \begin{align*}
       &= \left(-R\cdot \sin\sigma\cdot \sin \tau \right)^2 + \left( R\cdot \sin\sigma\cdot \cos\tau \right)^2 \\
       &= R^2\cdot \sin^2\sigma\cdot \sin^2 \tau + R^2\cdot \sin^2\sigma\cdot \cos^2\tau \\
       &= R^2\cdot \sin^2\sigma\left(\sin^2 \tau + \cos^2\tau\right) \\
       &= R^2\cdot \sin^2\sigma.
     \end{align*}
     Hence
     \[
     P_\mathrm{sph} =
  \begin{bmatrix}
    R^2 & 0 \\
    0 & R^2\cdot\sin^2 \sigma
  \end{bmatrix}.
     \]
  \end{freeResponse}
\end{problem}

\begin{definition}
  Let $\mathbf{v}_\mathrm{sph}$ and $\mathbf{w}_\mathrm{sph}$ be a vectors in
  $(\sigma,\tau)$-coordinates originating at the same
  $(\sigma,\tau)$-coordinate. Define
  \[
  \mathbf{v}_\mathrm{sph} \bullet_\mathrm{sph} \mathbf{w}_\mathrm{sph} = \mathbf{v}_\mathrm{sph}^\transpose \cdot P_\mathrm{sph}\cdot \mathbf{w}_\mathrm{sph}
  \]
  where
  \[
  P_\mathrm{sph} =
  \begin{bmatrix}
    R^2 & 0 \\
    0 & R^2\cdot\sin^2 \sigma
  \end{bmatrix}
  \]
  and $\sigma$ is determined by the coordinate that the vectors
  originate from.
\end{definition}


Now notice that you can write a path on the $R$-sphere by giving a
path
\[
\gamma_\mathrm{sph}(t) = \left( \sigma(t),\tau(t)\right)
\]
in the $(\sigma,\tau)$-plane.  To write a path that starts at the
North Pole, demand that $\sigma(0)=0$.  If you want the path to end on
the plane $y=\hat{y}=0$, demand additionally that $\tau(e)=0$. Given
such a path, its length is given by the formula%
 \[
   L=\int_{0}^e \sqrt{\left(\frac{d\sigma}{dt},\frac{d\tau}{dt}\right)
     \bullet_\mathrm{sph} \left(\frac{d\sigma}{dt},\frac{d\tau}{dt}\right)}\, dt
 \]
 since $\frac{d\gamma_\mathrm{sph}}{d t} \dot_\mathrm{sph} \frac{d\gamma_\mathrm{sph}}{d t}
 = \frac{d\gamma}{d t} \dot_K \frac{d\gamma}{d t} = \frac{d\hat \gamma}{d t} \dot \frac{d\hat\gamma}{d t}$.

\begin{problem}
  Prove that the shortest path on the $R$-sphere from the North Pole $(0,0,1)$
  (in $(\sigma,\tau)$-coordinates, $(0,0)$) to a point
  \[
  (x,y,z)=(R\sin e,0,\cos e)
  \]
  (in $\sigma,\tau)$-coordinates, $(e,0)$) is the downwards path lying in the
  plane $y=0$.
  \begin{hint}
    Start with some arbitrary path $(\sigma(t),\tau(t))$ which begins and ends at
    this point and show that it's longer than this path, in two steps:
    \begin{itemize}
    \item First use the integral above to show that it gets shorter if
      you keep the same $\sigma$ but make $\tau$ always zero (squishing the curve
      onto the plane $y=0$.)
    \item Finish the argument by eliminating any backtracking.
    \end{itemize}
  \end{hint}

  \begin{freeResponse}
    Write
    \begin{align*}
    L  &=\int_{0}^{\varepsilon} \sqrt{\left(1,\dd[\tau]{\sigma}\right)\bullet_\mathrm{sph} \left(1,\dd[\tau]{\sigma}\right)}\d\sigma\\
    &= \int_{0}^{\varepsilon} \sqrt{
      \begin{bmatrix} 1 & \dd[\tau]{\sigma}
      \end{bmatrix} \cdot P_\mathrm{sph}\cdot
      \begin{bmatrix} 1 & \dd[\tau]{\sigma}
      \end{bmatrix}^\transpose}\d\sigma \\
    &= \int_{0}^{\varepsilon} \sqrt{
      \begin{bmatrix} 1 & \dd[\tau]{\sigma}
      \end{bmatrix}
      \begin{bmatrix}
        R^2 & 0 \\
        0 & R^2\cdot\sin^2 \sigma
      \end{bmatrix}
      \begin{bmatrix} 1 \\ \dd[\tau]{\sigma}
    \end{bmatrix}}\d\sigma \\
    &= \int_{0}^{\varepsilon} \sqrt{
      R^2+R^2\sin^{2}\sigma\cdot \left(\frac{d\tau }{d\sigma}\right)^{2}
    }\d\sigma \\
    &= R\int_{0}^{\varepsilon} \sqrt{
      1+\sin^{2}\sigma\cdot \left(\frac{d\tau }{d\sigma}\right)^{2}
    }\d\sigma.
    \end{align*}
   Since $\sin^{2}\sigma$ is is positive for almost all $\sigma\in[
     0,\varepsilon] $, $L$ is minimal only when
   $\frac{d\tau}{d\sigma}$ is identically $0$. But this means that
   $\tau\left( \sigma\right) $ is a constant function. Since
   $\tau\left( 0\right) =0$, this means that $\tau\left( \sigma\right)
   $ is identically $0$. Hence our path is determined by
   \begin{align*}
     x(\sigma,\tau) &=R\cdot \sin\sigma,\\
     y(\sigma,\tau) &=0,\\
     z(\sigma,\tau) &=\cos \sigma,
   \end{align*}
   and this corresponds to a circular arc embedded in the plane
   $y=\hat{y}=0$.
  \end{freeResponse}

\end{problem}









\subsection{Shortest path between any two points}

We next prove the theorem that shows that shortest path on the surface
of the Earth from Rio de Janeiro to Los Angeles is the one cut on the
surface of the Earth by the plane that passes through the center of
the Earth and through Rio and through Los Angeles. That is usually the
route an airplane would take when flying between the two cities.


\begin{theorem}
Given any two points $X_{1}=\left(x_{1},y_{1},z_{1}\right) $ and
$X_{2}=\left(x_{2},y_{2},z_{_{2}}\right) $ in $K$-geometry, the
shortest path between the two points is the path cut out by the set
\[
K\left(  x^{2}+y^{2}\right)  +z^{2}=1
\]
and the plane containing $(0,0,0)$, $X_{1}$, and $X_{2}$.
\end{theorem}

\begin{problem} %\textbf{(Tricky!)}
  Explain in words how to prove this theorem by using $K$-rigid
  motions of the form
  \[
  M_\theta=
  \begin{bmatrix}
    \cos\theta & -\sin\theta & 0\\
    \sin\theta & \cos\theta & 0\\
    0 & 0 & 1
  \end{bmatrix}
  \qquad\text{and}\qquad
  N_\psi=
  \begin{bmatrix}
    \cos\psi & 0 & -R\cdot\sin\psi\\
    0 & 1 & 0\\
    R^{-1}\cdot\sin\psi & 0 & \cos\psi
  \end{bmatrix}.
  \]
  \begin{hint}
    $M_\theta$ is a $K$-rigid motion that rotates around the $z$-axis and
    $N_\psi$ is a $K$-rigid motion that rotates around the $y$-axis.
  \end{hint}
  \begin{hint}
    You should apply \textit{two} $K$-rigid motions of the form
    $M_\theta$ (for different angles) and one $K$-rigid motion of the
    form $N_\psi$, though not necessarily in that order!
  \end{hint}
  \begin{freeResponse}
    Given $X_1$ and $X_2$, we may instead consider $X_1\cdot M_\theta$
    and $X_2\cdot M_\theta$ where $\theta$ is chosen so that $X_1\cdot
    M_\theta$ is in the plane $y=0$.

    Next consider $X_1\cdot M_\theta\cdot N_\psi$ and $X_2\cdot
    M_\theta\cdot N_\psi$ where $\psi$ is chosen so that $X_1\cdot
    M_\theta\cdot N_\psi$ is at the North Pole.

    Finally consider $X_1\cdot M_\theta\cdot N_\psi\cdot M_\varphi$
    and $X_2\cdot M_\theta\cdot N_\psi\cdot M_\varphi$ where $\varphi$
    is chosen so that $X_1\cdot M_\theta\cdot N_\psi\cdot M_\varphi$
    is at the North Pole and $X_2\cdot M_\theta\cdot N_\psi\cdot
    M_\varphi$ is in the plane $y=0$.

    Now by our previous work, the shortest path between $X_1\cdot
    M_\theta\cdot N_\psi\cdot M_\varphi$ and $X_2\cdot M_\theta\cdot
    N_\psi\cdot M_\varphi$ is the great circular arc in the plane
    $y=0$. Applying $M_\varphi^{-1}\cdot N_\psi^{-1}\cdot
    M_\theta^{-1}$ to our ``moved'' points will move them back again,
    and the shortest path is the transformed great circular arc.
  \end{freeResponse}
\end{problem}

%% \begin{theorem}
%% Given any two points $X_{1}=\left(x_{1},y_{1},z_{1}\right) $ and
%% $X_{2}=\left(x_{2},y_{2},z_{_{2}}\right) $ in $K$-geometry, the
%% shortest path between the two points is the path cut out by the two
%% equations
%% \[
%% K\left(  x^{2}+y^{2}\right)  +z^{2}=1
%% \]
%% \begin{equation}
%% \left\vert \left(
%% \begin{array}
%% [c]{ccc}%
%% x & y & z\\
%% x_{1} & y_{1} & z_{1}\\
%% x_{2} & y_{2} & z_{2}%
%% \end{array}
%% \right)  \right\vert =0, \label{63}%
%% \end{equation}
%% that is, the plane containing $\left(  0,0,0\right)  $ and $X_{1}$ and $X_{2}$.
%% \end{theorem}

%% \begin{proof}
%% By a previous problem there is a $K$-rigid motion $M$ that takes
%% $X_{1}$ to the North Pole $N$ and $X_{2}$ to $\left(
%% K^{-1/2}\sin\varepsilon,0,\cos\varepsilon \right) $ for some
%% $\varepsilon$. That is%
%% \[
%% X_{2}\cdot M=\left(  R\cdot \sin \varepsilon
%% ,0,\cos \varepsilon\right)
%% \]
%% for some $\varepsilon$ since all points in $K$-geometry with \underline{$y$%
%% }$=0$ can be written as $\left(  R\cdot \sin %
%% \varepsilon,0,\cos \varepsilon\right)  $ for some $\varepsilon$. But%
%% \begin{align*}
%% \left\vert \left(
%% \begin{array}
%% [c]{ccc}%
%% \underline{x} & \underline{y} & \underline{z}\\
%% 0 & 0 & 1\\
%% K^{-1/2}\sin\varepsilon & 0 & \cos\varepsilon
%% \end{array}
%% \right)  \right\vert  &  =\left\vert \left(
%% \begin{array}
%% [c]{ccc}%
%% x & y & z\\
%% x_{1} & y_{1} & z_{1}\\
%% x_{2} & y_{2} & z_{2}%
%% \end{array}
%% \right)  \cdot M\right\vert \\
%% &  =\left\vert \left(
%% \begin{array}
%% [c]{ccc}%
%% x & y & z\\
%% x_{1} & y_{1} & z_{1}\\
%% x_{2} & y_{2} & z_{2}%
%% \end{array}
%% \right)  \right\vert \cdot\left\vert M\right\vert =0,
%% \end{align*}
%% Since $\left\vert M\right\vert \neq0$ and $K^{-1/2}\sin\varepsilon\neq0$ if
%% $\varepsilon<\pi$, $\left(  x,y,z\right)  $ lies in the plane $\left(
%% \ref{63}\right)  $ if and only if
%% \[
%% \underline{y}=0.
%% \]
%% Since $M$ is a $K$-rigid motion it must take the shortest path from $X_{1}$ to
%% $X_{2}$ to the shortest path from $X_{1}\cdot M=N$ to $X_{2}\cdot M=\left(
%% R\cdot \sin \varepsilon,0,\cos %
%% \varepsilon\right)  $. But we already know that the shortest path from
%% $X_{1}\cdot M$ to $X_{2}\cdot M$ is the one cut out by the plane $y=0$. But
%% that path comes from the path cut out by the plane given by equation $\left(
%% \ref{63}\right)  $. This path is called the \textit{great circular arc}
%% between $X_{1}$ and $X_{2}$.
%% \end{proof}

\begin{definition}
A \dfn{line} in spherical geometry will be a curve that extends
infinitely in each direction and has the property that, given any two
points $X_{1}$ and $X_{2}$ on the path, the shortest path between
$X_{1}$ and $X_{2}$ lies along that curve.

Lines in spherical geometry are usually called great circles on the
$R$-sphere. They are the intersections of the $R$-sphere with planes
through $(0,0,0)$.
\end{definition}

%% Letting $X_{2}$ approach $X_{1}$ along the great circular arc joining $X_{1}$
%% and $X_{2}$ we see that the solution set to equation $\left(  \ref{63}\right)
%% $ does not change. Taking a limit as $X_{2}$ approaches $X_{1}$, this set can
%% also be expressed as the solution set of the equation%
%% \[
%% \left\vert \left(
%% \begin{array}
%% [c]{ccc}%
%% x & y & z\\
%% x_{1} & y_{1} & z_{1}\\
%% a_{1} & b_{1} & c_{1}%
%% \end{array}
%% \right)  \right\vert =0
%% \]
%% where $\left(  a_{1},b_{1},c_{1}\right)  $ is a tangent vector at the point
%% $X_{1}$ pointing in the direction of $X_{2}.$

\subsection{The spherical Pythagorean Theorem}

To start we need some basic facts about lengths of lines in spherical
geometry.



\begin{problem}
  Given a line in spherical geometry lying entirely in the plane $y=0$,
  \begin{align*}
    x(t) &= R\sin t,\\
    y(t) &= 0,\\
    z(t) &= \cos t,
  \end{align*}
  show that the length of the segment from $0 \leq t \leq e$ is exactly $Re$.
  \begin{hint}
    Use a previous problem.
  \end{hint}
  \begin{freeResponse}
    By a previous problem the length of this line is given by
    \[
    L=R \cdot \int_{0}^e 1 \d\sigma = Re.
    \]
  \end{freeResponse}
\end{problem}

\begin{problem}
  Explain in words how to prove that given two points on $R$-sphere,
  say $A$ and $B$, the length of the spherical line connecting them
  is given by
  \[
  R\cdot e = R\cdot\arccos\left(\frac{A\bullet_K B}{|A|_K\cdot |B|_K}\right).
  \]
  by using $K$-rigid motions of the form
  \[
   M_\theta=
  \begin{bmatrix}
    \cos\theta & -\sin\theta & 0\\
    \sin\theta & \cos\theta & 0\\
    0 & 0 & 1
  \end{bmatrix}
  \qquad\text{and}\qquad
  N_\psi=
  \begin{bmatrix}
    \cos\psi & 0 & -R\cdot\sin\psi\\
    0 & 1 & 0\\
    R^{-1}\cdot\sin\psi & 0 & \cos\psi
  \end{bmatrix}.
  \]
  \begin{freeResponse}
    The problem is essentially the same as a previous problem. Hence one must consider
    \[
    A\cdot M_\theta\cdot N_\psi\cdot M_\varphi \qquad\text{and}\qquad
    B\cdot M_\theta\cdot N_\psi\cdot M_\varphi
    \]
    where $\theta$, $\psi$, and $\varphi$ are chosen to place $A$ on
    the North Pole and $B$ in the plane $y=0$.

    Now we know the distance between the points to be $R\cdot
    \varepsilon$. Since $K$-rigid motions preserve distance and angle,
    this completes the proof.
  \end{freeResponse}
\end{problem}


We will now give the spherical analogue of the Pythagorean Theorem.

\begin{theorem}[Spherical Pythagorean Theorem]
  If $\triangle ABC$ is a right triangle on the $R$-sphere with right
  angle $\angle ACB$, and side $a$ opposite $A$, $b$ opposite $B$,
  and $c$ opposite $C$, then
  \[
  \cos\left(\frac{c}{R}\right)=\cos\left(\frac{a}{R}\right)\cos\left(\frac{b}{R}\right).
  \]
\end{theorem}

Let's see why this theorem is true.  We may via $K$-rigid motions
place the triangle so that $C$ is at the North Pole, $A$ is in the
plane $y=0$, and $B$ is in the plane $x=0$ (note $A$ and $B$ may
be switched---if this is the case, simply rename them). In this case,
\begin{align*}
  A &= (R\cdot \sin\alpha, 0, \cos\alpha),\\
  B &= (0, R\cdot \sin \beta, \cos\beta).
\end{align*}
%% \begin{image}
%%   \includegraphics[width=4in]{sphPythag.png}
%% \end{image}
\begin{center}
  \begin{tikzpicture}[geometryDiagrams,scale=1.7]  
      %% x-axis
      \draw [thin,->] (2.2,1.1)--(-2.2,-1.1); 
      \node[below left] at (-2.2,-1.1) {$x$};

      %% y-axis
      \draw [thin,->] (-2.2,0)--(2.5,0); 
      \node[right] at (2.5,0) {$y$};

      %% z-axis
      \draw [thin,->] (0,-2)--(0,2.2); 
      \node[above] at (0,2.2) {$z$};

      
      
      %% sphere
      \draw[thick] (1.75,0) arc (0:360:1.75);
      %%%% Equator
      \draw[thick] (-1.75,0) arc (180:360:1.75 and .5);
      \draw[thin,dashed,gray] (1.75,0) arc (0:180:1.75 and .5);

      %% triangle
      \draw[rotate around={90:(0,0)}] (1.75,0) arc (0:75:1.75 and .9);
      \draw (0,1.75) arc (90:35:1.75);
      \draw[rotate around={33:(0,0)}] (1.75,0) arc (0:106:1.75 and .9);



      \draw[thin,gray] (0,0)--(-.86,.5);

      \draw[thin,gray] (0,0)--(1.43,1);


      
      
      %%%% points on sphere
      \draw[fill=black] (0,1.75) circle (.05);
      \node[above right] at (0,1.75) {$C$};


      \draw[fill=black] (-.86,.5) circle (.05);
      \node[left] at (-.86,.5) {$A$};

      
      \draw[fill=black] (1.43,1) circle (.05);
      \node[right] at (1.43,1) {$B$};

      \node at (-.1,.2) {$\alpha$};
      \draw[rotate around={90:(0,0)},thin,->] (.5,0) arc (0:70:.5 and .25);
      
      \node at (.15,.3) {$\beta$};
      \draw[thin,->] (0,.6) arc (90:40:.6);


      \node at (.8,1.7) {$a$};
      \node at (-.8,1.3) {$b$};
      \node at (.15,.9) {$c$};
\end{tikzpicture}  
\end{center}
Hence the length of side $b$ is $R\cdot\alpha$. Working analogusly (or
by using the rigid motion $M_{\pi/2}$ to move side $a$ to the plane
$y=0$) see that the length of side $a$ is $R\cdot \beta$. Set
\[
\gamma = \arccos\left(\frac{A\bullet_K B}{|A|_K\cdot |B|_K}\right).
\]
Since we are working on the $R$-sphere,
\begin{align*}
  R^2\cdot \cos \gamma &= A\bullet_K B\\
  &=
  \begin{bmatrix}
    R\cdot \sin\alpha &  0 & \cos\alpha
  \end{bmatrix}
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
      0 & 0 & R^2
    \end{bmatrix}
    \begin{bmatrix}
      0\\
      R\cdot\sin\beta\\
      \cos\beta
    \end{bmatrix}\\
   &=R^2 \cdot \cos\alpha \cdot \cos\beta.
\end{align*}


\begin{problem}
  Explain how to progress from the fact that
  \[
  R^2\cdot \cos \gamma = R^2 \cdot \cos\alpha \cdot \cos\beta.
  \]
  to the conclusion of the theorem
  \[
  \cos\left(\frac{c}{R}\right)=\cos\left(\frac{a}{R}\right)\cos\left(\frac{b}{R}\right).
  \]
  \begin{freeResponse}
    As we have seen
    \[
    \begin{split}
      R\cdot \alpha &= a,\\
      R\cdot \beta  &= b,\\
      R\cdot \gamma &= c,
    \end{split}
    \qquad\text{so}\qquad
    \begin{split}
      \alpha &= \frac{a}{R},\\
      \beta  &= \frac{b}{R},\\
      \gamma &= \frac{c}{R},
    \end{split}
    \]
    and hence
    \[
    \cos\left(\frac{c}{R}\right)=\cos\left(\frac{a}{R}\right)\cos\left(\frac{b}{R}\right).
    \]
  \end{freeResponse}
\end{problem}


\begin{problem}
  Use the Taylor series expansion of $\cos(x)$ centered around $x=0$,
  \[
  \cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots
  \]
to show that for ``small'' triangles, the spherical Pythagorean
Theorem reduces to the euclidean Pythagorean Theorem, meaning
\[
c^2 \approx a^2+b^2.
\]
\begin{freeResponse}
  If
  \[
  \cos\left(\frac{c}{R}\right)=\cos\left(\frac{a}{R}\right)\cos\left(\frac{b}{R}\right),
  \]
  then we may replace each cosine with its Taylor series expansion
  \[
  1 - \frac{\left(\frac{c}{R}\right)^2}{2!} + \frac{\left(\frac{c}{R}\right)^4}{4!} - \frac{\left(\frac{c}{R}\right)^6}{6!} + \cdots
  \]
  \[
  =\left(
  1 - \frac{\left(\frac{a}{R}\right)^2}{2!} + \frac{\left(\frac{a}{R}\right)^4}{4!} - \frac{\left(\frac{a}{R}\right)^6}{6!} + \cdots
  \right)
  \left(
  1 - \frac{\left(\frac{b}{R}\right)^2}{2!} + \frac{\left(\frac{b}{R}\right)^4}{4!} - \frac{\left(\frac{b}{R}\right)^6}{6!} + \cdots
  \right).
  \]
  Expanding this out, and discarding higher-order terms (as they will
  go to zero when $R$ is large relative to $a$, $b$, and $c$) we find
  \[
  \frac{-1}{2}\left(\frac{c}{R}\right)^2 = \frac{-1}{2}\left(\frac{a}{R}\right)^2+\frac{-1}{2}\left(\frac{b}{R}\right)^2.
  \]
  Multiplying both sides of the equation by $-2R^2$, we see that for a
  ``small'' right triangle on a sphere,
  \[
  c^2 \approx a^2 +b^2.
  \]
\end{freeResponse}
\end{problem}


\begin{problem}
Summarize the results from this section. In particular, indicate which
results follow from the others.
\begin{freeResponse}
We started off by parameterizing the $R$-sphere in $K$-geometry in $\left(\sigma,\tau \right)$-coordinates. Then, we computed the $K$-dot product in  $\left(\sigma,\tau \right)$-coordinates. This lead to the following definition of the spherical dot product of two vectors originating at the same $\left(\sigma,\tau \right)$-coordinate: 
\[
  V_\mathrm{sph} \bullet_\mathrm{sph} W_\mathrm{sph} = V_\mathrm{sph} \cdot P_\mathrm{sph} \cdot W_\mathrm{sph}^\transpose
  \]
  where
  \[
  P_\mathrm{sph} =
  \begin{bmatrix}
    R^2 & 0 \\
    0 & R^2\cdot\sin^2 \sigma
  \end{bmatrix}.
  \]
We also proved, using $\left(\sigma,\tau \right)$-coordinates, that the shortest path, on the $R$-sphere, from the north pole to a point in the $y=0$ plane is the path lying on the $y=0$ plane. Then we used this to show that the shortest path between any two points on the $R$-sphere is the path cut by the intersection of the $R$-sphere and the plane through both points and the origin. As a result, we learned that lines in spherical geometry are usually called great circles on the $R$-sphere, which are the intersections of the $R$-sphere with plane through $\left(0, 0, 0\right)$. Lastly, we applied the previous work to prove the analogue to the Pythagorean Theorem in spherical geometry. 
\end{freeResponse}
\end{problem}




\end{document}
