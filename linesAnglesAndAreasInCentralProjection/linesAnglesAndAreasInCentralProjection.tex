\documentclass[newpage,hints,12pt,noauthor,handout,nooutcomes]{ximera}

\input{../preamble.tex}

\title{Lines, angles, and areas in central projection}

\begin{document}
\begin{abstract}
  Here we look at lines, angles, and areas in central projection coordinates. 
\end{abstract}
\maketitle

\subsection{Central projection preserves lines}

We all probably realize that you can't make a perfect flat map of our
spherical world.  What this means is that either great circular arcs
on the sphere won't correspond to straight lines on the map, or angles
on the sphere be equal to the corresponding angles on the map.  We do
the next best thing---we make two maps of the sphere!  One map has the
property that straight lines on the map correspond to shortest paths,
and the other map has the property that angles are faithfully
represented. We will now show that in central projection, straight
lines correspond to shortest paths, but angles are not faithfully
represented.

\begin{problem}
  Show that ``lines'' in $K$-geometry correspond to actual lines in
  $(x_{c},y_{c})$-coordinates under central projection.

\begin{hint}
  Referring to previous handouts, explain why intersecting the $K$-surface
  \[
  1 = K(x^2+y^2) + z^2 
  \]
  with the plane
  \[
  ax+by+cz = 0
  \]
  produces a $K$-geometry line.
\end{hint}

\begin{hint}
  Argue that the central projection to the plane $z=1$ of a point on the
  $K$-surface which lies in the plane
  $$ax+by+cz=0$$
  also lies in that plane.  What is the intersection of two planes?
\end{hint}

\begin{freeResponse}
  Let's start by intersecting the surfaces
  \[
  K(x^2+y^2)+z^2=1\qquad\text{and}\qquad ax+by+cz=0,
  \]
  where the latter is a plane passing through the origin. Write
  \[
  K(x^2+y^2)+z^2-ax-by-cz=1.
  \]
  Now use the projection formulas. Since these formula necessarily
  produce points on the surface
  \[
  1 = K\left(x^2+y^2\right) + z^2,
  \]
  we may replace $K\left(x^2+y^2\right) + z^2$ with $1$ and write
  \begin{align*}
    1-\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=1\\
    -\frac{ax_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}- \frac{by_c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}}-\frac{c}{\sqrt{K\left(x_c^2 + y_c^2\right)+1}} &=0.
  \end{align*}
  Since $\sqrt{K\left(x_c^2 + y_c^2\right)+1} \ne 0$, we may clear
  denominators to find the following equation for a line
  \[
  ax_c+by_c+c= 0.
  \]
\end{freeResponse}
\end{problem}

\begin{problem}
  Explain why the answer from the previous question makes perfect sense if $K=0$.
  \begin{freeResponse}
    If $K=0$, our surface is the plane $z=1$, as we only consider the
    top sheet. In this case, we are intersecting the plane $z=1$ with
    the plane $ax+by+z=0$. This clearly gives the plane $ax_c+ by_c +
    1 = 0.$
  \end{freeResponse}
\end{problem}

\begin{problem}
  If $K<0$ explain why Euclid's fifth axiom:
  \begin{quote}
    Through a point not on a line there passes a unique parallel line.
  \end{quote}
  fails.
  \begin{freeResponse}
    Given a point not on a line, we see that there are many lines
    parallel to the original line through that point.
  \end{freeResponse}
\end{problem}

\begin{problem}
  If $K>0$ reconcile the fact
  \begin{quote}
    in spherical geometry, there are no parallel lines,
  \end{quote}
  with the fact that 
  \begin{quote}
    The lines $y_c=1$ and $y_c = -1$ seem to be parallel.
  \end{quote}
  \begin{freeResponse}
    These two lines are given by great circles that meet at the
    equator. Since the equator maps to `infinity' we say they meet at
    `infinity.'
  \end{freeResponse}
\end{problem}

\subsection{Angles in central projection coordinates}

While central projection coordinates ``preserve'' lines, meaning that
shortest paths in euclidean geometry, spherical geometry, and
hyperbolic geometry are all mapped to lines, it does not preserve
angles. This means that the angle that we see in central projection
coordinates may or may not be the same as the angle in euclidean
geometry. To see this, we will give an example where the appearance of
the angle is changed by a rigid motion.


\begin{problem}
  Consider the following lines in the Klein disk,
  \begin{image}
    \includegraphics[width=2.5in]{kleinDiskNonConformal.png}
  \end{image}
  where $\overline{A'B'}$ and $\overline{C'D'}$ are the images of
  $\overline{AB}$ and $\overline{CD}$ under a $K$-rigid
  motion. Explain how this image shows that central projection does
  not preserve angles.
  
  \begin{freeResponse}
  In the image its seems as though the larger arc intersected by $\overline{CD}$ and $\overline{AB}$ is greater than the larger arc intersected by $\overline{C'D'}$ and $\overline{A'B'}$. Therefore, it appears as though the angle created by $\overline{CD}$ and $\overline{AB}$ is greater than the angle created by $\overline{C'D'}$ and $\overline{A'B'}$ even though the lines are transformed by rigid motions. 
  \end{freeResponse}
\end{problem}


\subsection{Areas in central projection coordinates}



We have already seen that on the $R$-sphere, the area of an
$\alpha$-lune is $2\alpha\cdot R^2$. Let's compute this a different
way.

\begin{problem}
  Let $K>0$ and consider the following region in central projection
  \begin{center}
    \begin{tikzpicture}[geometryDiagrams,scale=3]  

  \begin{scope}
    \clip (0,0) -- ({1.3*cos(50)},{1.3*sin(50)}) -- (1.3,0) --cycle;
    \fill[fill=black!5!white] (0,0) rectangle (1.3,1.3);
  \end{scope}
  \draw[draw=none,fill=black!5!white] (1.3,0) arc (0:50:1.3);
  
  
  \begin{scope}
    \clip (0,0) -- ({1.15*cos(50)},{1.15*sin(50)}) -- (1.3,0) --cycle;
    \fill[fill=black!7!white] (0,0) rectangle (1.15,1.15);
  \end{scope}
  \draw[draw=none,fill=black!7!white] (1.15,0) arc (0:50:1.15);

  
  \begin{scope}
    \clip (0,0) -- ({cos(50)},{sin(50)}) -- (1,0) --cycle;
    \fill[fill=black!10!white] (0,0) rectangle (1,1);
  \end{scope}
  \draw[draw=none,fill=black!10!white] (1,0) arc (0:50:1);


  \draw (0,0)--({cos(50)},{sin(50)});
  \draw (0,0)--(1,0);

    \draw[dashed] ({cos(50)},{sin(50)}) --  ({1.3*cos(50)},{1.3*sin(50)});
    \draw[dashed] (1,0)--(1.3,0);

  \draw[domain=0:50,thick,smooth] plot ({.25*cos(\x)},{.25*sin(\x)});

  \node at (.15,.07) {$\alpha$};

    %% x-axis
  \draw[thin,->] (-.5,0)--(1.5,0); 
  \node[right] at (1.5,0) {$x_c$};
  %% y-axis
  \draw[thin,->] (0,-.5)--(0,1); 
  \node[above] at (0,1) {$y_c$};
\end{tikzpicture}  
  \end{center}
 Use the fact that the area of an $\alpha$-lune is $2\alpha\cdot R^2$
 to compute the area of the region.
 \begin{freeResponse}
In central projection we are only considering the top half of the $R$-sphere in $K$-geometry, therefore, when projecting the region of the $\alpha$-lune, we only project half of it. Hence, the above region is half of the area of the $\alpha$-lune on the $R$-sphere, and has an area of $\alpha \cdot R^{2}$.
 \end{freeResponse}
\end{problem}



On the other hand, we know the area of the parallelogram spanned by two vectors in
  $K$-warped space is%
  \begin{align*}
  \sqrt{\det
    \begin{bmatrix}
      \mathbf{v}\bullet_{K}\mathbf{v} & \mathbf{w}\bullet_{K}\mathbf{v}\\
      \mathbf{v}\bullet_{K}\mathbf{w} & \mathbf{w}\bullet_{K}\mathbf{w}
    \end{bmatrix}}
  &=\sqrt{\det
    \begin{bmatrix}
      \mathbf{v}_c\bullet_{c}\mathbf{v}_c & \mathbf{w}_c\bullet_{c}\mathbf{v}_c\\
      \mathbf{v}_c\bullet_{c}\mathbf{w}_c & \mathbf{w}_c\bullet_{c}\mathbf{w}_c
    \end{bmatrix}}\\
  &=
  \sqrt{\det\left({\renewcommand*{\arraystretch}{1.4} 
      \begin{bmatrix}
        \mathbf{v}_c^\transpose \\
        \mathbf{w}_c^\transpose
      \end{bmatrix}}
      \cdot P_c\cdot 
      \begin{bmatrix}
        \mathbf{v}_c & \mathbf{w}_c%
      \end{bmatrix}
    \right) }.
  \end{align*}
  In particular, if we want to know the area spanned by unit vectors
  \[
  \mathbf{v}_c = \begin{bmatrix}
    1\\
    0
  \end{bmatrix}
  \qquad\text{and}\qquad
    \mathbf{w}_c = \begin{bmatrix}
    0\\
    1
  \end{bmatrix}
    \]
    we find the area is exactly $\sqrt{\det P_c}$. This means that to
    compute area of a region $L_c$ using integrals, but in central
    projection, we use
    \[
    \iint_{L_c} \sqrt{\det P_c}\d x_c\d y_c.
    \]


\begin{problem}
  Compute $\sqrt{\det P_c}$.
  \begin{hint}
    As a gesture of friendship, we'll remind you that
    \[
 P_c =
     \begin{bmatrix}
       \left(Ky_c^2+1\right)\lambda^4 & -Kx_{c}y_{c}\lambda^4\\
       -Kx_{c}y_{c}\lambda^4 & \left(Kx_c^2+1\right)\lambda^4
     \end{bmatrix}.
    \]
  \end{hint}
  \begin{freeResponse}
    Write
    \begin{align*}
    \det P_c &= \lambda^4\cdot \det \begin{bmatrix}
       Ky_c^2+1 & -Kx_{c}y_{c}\\
       -Kx_{c}y_{c} & \left(Kx_c^2+1\right)
    \end{bmatrix}\\
    &= \lambda^4\cdot\left(\left( Ky_c^2+1\right)\left(Kx_c^2+1\right) - K^2x_{c}^2y_{c}^2\right)\\
    &= \lambda^4\cdot\left(K^2x_{c}^2y_{c}^2 + Ky_c^2+Kx_c^2+1-K^2x_{c}^2y_{c}^2\right)\\
    &= \lambda^4\cdot\left(Ky_c^2+Kx_c^2+1\right)
    \end{align*}
    However, $\lambda = \frac{1}{K\left(x_c^2+y_c^2\right)+1}$, so
    \[
    \sqrt{\det P_c} = \frac{1}{\left(K\left(x_c^2+y_c^2\right)+1\right)^{3/2}}.
    \]
  \end{freeResponse}
\end{problem}

At this point we see we are interested in the following integral
\[
\iint_{L_c} (K(x_c^2+y_c^2)+1)^{-3/2} \d x_c\d y_c.
\]

\begin{problem}
  Examining the following diagram
  \begin{center}
    \begin{tikzpicture}[geometryDiagrams,scale=3]  

  \begin{scope}
    \clip (0,0) -- ({1.3*cos(50)},{1.3*sin(50)}) -- (1.3,0) --cycle;
    \fill[fill=black!5!white] (0,0) rectangle (1.3,1.3);
  \end{scope}
  \draw[draw=none,fill=black!5!white] (1.3,0) arc (0:50:1.3);
  
  
  \begin{scope}
    \clip (0,0) -- ({1.15*cos(50)},{1.15*sin(50)}) -- (1.3,0) --cycle;
    \fill[fill=black!7!white] (0,0) rectangle (1.15,1.15);
  \end{scope}
  \draw[draw=none,fill=black!7!white] (1.15,0) arc (0:50:1.15);

  
  \begin{scope}
    \clip (0,0) -- ({cos(50)},{sin(50)}) -- (1,0) --cycle;
    \fill[fill=black!10!white] (0,0) rectangle (1,1);
  \end{scope}
  \draw[draw=none,fill=black!10!white] (1,0) arc (0:50:1);


  \draw (0,0)--({cos(50)},{sin(50)});
  \draw (0,0)--(1,0);

    \draw[dashed] ({cos(50)},{sin(50)}) --  ({1.3*cos(50)},{1.3*sin(50)});
    \draw[dashed] (1,0)--(1.3,0);

  \draw[domain=0:50,thick,smooth] plot ({.25*cos(\x)},{.25*sin(\x)});

  \node at (.15,.07) {$\alpha$};

    %% x-axis
  \draw[thin,->] (-.5,0)--(1.5,0); 
  \node[right] at (1.5,0) {$x_c$};
  %% y-axis
  \draw[thin,->] (0,-.5)--(0,1); 
  \node[above] at (0,1) {$y_c$};
\end{tikzpicture}  
  \end{center}
  convert
  \[
  \iint_{L_c} (K(x_c^2+y_c^2)+1)^{-3/2} \d x_c\d y_c.
  \]
  to polar coordinates and compute the integral.
  \begin{hint}
    Recall that to convert to polar coordinates, set
    \begin{align*}
      r &= \sqrt{x_c^2+y_c^2},\\
      \theta &= \arctan(y_c/x_c),
    \end{align*}
    and replace $\d x_c\d y_c$ with $r\d r\d \theta$.
  \end{hint}
  \begin{freeResponse}
    Write
    \[
    \int_{L_c}
    \left(K(x_c^2+y_c^2)+1\right)^{-3/2} \d x_c\d
    y_c = \int_0^\alpha \int_0^\infty \left(K\cdot r^2+1\right)^{-3/2} r\d r \d \theta.
    \]
    Integrating this from the inside-out we find
    \begin{align*}
      \int_0^\alpha \int_0^\infty \left(K\cdot r^2+1\right)^{-3/2} r\d r \d \theta
      &= \int_0^\alpha \eval{\frac{-\left(K\cdot r^2+1\right)^{-1/2}}{K}}_0^\infty \d \theta\\
      &= \int_0^\alpha \frac{1}{K} \d \theta\\
      &= \frac{\alpha}{K}.   
    \end{align*}
    Recalling that $K = \frac{1}{R^2}$ we find our final answer is $\alpha \cdot R^2$.
  \end{freeResponse}
\end{problem}

Hopefully you got the same area that you predicted in the previous problem!

\subsection{Central projection unifies euclidean, spherical, and hyperbolic geometry}

Under central projection, our new dot product defined by
\[
\mathbf{v}_c \bullet_c \mathbf{w}_c = \mathbf{v}_c^\transpose \cdot P_c \cdot \mathbf{w}_c
\]
make sense when $K$ is zero, positive, and negative. Hence this dot
product makes sense for euclidean, spherical, and hyperbolic
geometry. Moreover, in central projection, shortest paths on the $K$-surface
\[
K(x^2 + y^2) + z^2 = 1
\]
map to lines in the plane $z=1$. However, there is one trade-off:
Angles are not preserved in central projection. This means that when
angles are projected into the plane via central projection, the angle
we see in the $(x_c,y_c)$-plane may or may not be the actual angle
between two vectors. Summarizing, we have:


\[
  {\renewcommand{\arraystretch}{2.7}
  \begin{array}{|c||c|c|c|}\hline
    & \text{Spherical (}K>0) & \text{Euclidean (}K=0) & \text{Hyperbolic (}K<0)\\
    \hline\hline
    \text{Surface in euclidean space}
    & \hat{x}^{2}+\hat{y}^{2}+\hat{z}^{2}=R^{2} & \text{DNE}  & \text{DNE} \\\hline
    \text{Euclidean dot product} & \hat{\mathbf v}^\transpose\cdot \hat{\mathbf w}
                             & \text{DNE}  & \text{DNE}\\\hline
    \text{Surface in $K$-warped space}
    & {1=K(x^{2}+y^{2})+z^{2}} & 1=K(x^{2}+y^{2})+z^{2} & 1=K(x^{2}+y^{2})+z^{2}\\\hline
    K\text{-dot product}
    & \mathbf v^\transpose \left[\begin{smallmatrix}
        1 & 0 & 0\\
        0 & 1 & 0\\
        0 & 0 & K^{-1}
      \end{smallmatrix}\right] \mathbf w &  \text{DNE}
    & \mathbf{v}^\transpose \left[\begin{smallmatrix}1 & 0 & 0\\ 0 & 1 & 0\\ 0 & 0 & K^{-1}\end{smallmatrix}\right]\mathbf w \\\hline
    \text{Central dot product} & \multicolumn{3}{c|}{
        \mathbf{v}_c^\transpose \cdot P_c \cdot \mathbf{w}_c
        = \mathbf{v}_c^\transpose\left[\begin{smallmatrix}
            \left(Ky_c^2+1\right)\lambda^4 & -Kx_{c}y_{c}\lambda^4 \\
            -Kx_{c}y_{c}\lambda^4 & \left(Kx_c^2+1\right)\lambda^4
          \end{smallmatrix}\right] \mathbf{w}_c}\\\hline
\end{array}}
\]




\begin{problem}
Summarize the results from this section. In particular, indicate which
results follow from the others.
\begin{freeResponse}
\end{freeResponse}
\end{problem}

\end{document}
